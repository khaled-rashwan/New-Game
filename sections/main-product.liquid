{% comment %}
  Product Page Template - Gaming Store Style
{% endcomment %}

<style>
  .product-page {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
  }

  .breadcrumb {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 30px;
    font-size: 14px;
    color: #666;
  }

  .breadcrumb a {
    color: #666;
    text-decoration: none;
  }

  .breadcrumb a:hover {
    color: #000;
  }

  .product-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 40px;
    margin-bottom: 60px;
  }

  .product-images {
    position: relative;
  }

  .sale-badge {
    position: absolute;
    top: 20px;
    left: 20px;
    background: #ff0000;
    color: white;
    padding: 6px 16px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 600;
    z-index: 10;
  }

  .main-image {
    width: 100%;
    aspect-ratio: 1;
    background: #f5f5f5;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 15px;
  }

  .main-image img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
  }

  .thumbnail-container {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
  }

  .thumbnail {
    aspect-ratio: 1;
    background: #f5f5f5;
    border-radius: 8px;
    cursor: pointer;
    border: 2px solid transparent;
    transition: border-color 0.3s;
  }

  .thumbnail.active {
    border-color: #ff6b00;
  }

  .thumbnail:hover {
    border-color: #ff6b00;
  }

  .thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: 6px;
  }

  .product-info {
    display: flex;
    flex-direction: column;
  }

  .product-meta {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
  }

  .category-badge {
    background: #f0f0f0;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
  }

  .stock-badge {
    background: #000;
    color: white;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
  }

  .product-title {
    font-size: 36px;
    font-weight: 700;
    margin: 0 0 15px 0;
  }

  .product-rating {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 25px;
  }

  .stars {
    display: flex;
    gap: 2px;
    color: #ffc107;
    font-size: 18px;
  }

  .rating-score {
    font-weight: 600;
    font-size: 14px;
  }

  .review-count {
    color: #666;
    font-size: 14px;
  }

  .product-specs {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin-bottom: 30px;
    padding: 20px 0;
  }

  .spec-item {
    text-align: center;
  }

  .spec-icon {
    width: 40px;
    height: 40px;
    margin: 0 auto 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #ff6b00;
    font-size: 24px;
  }

  .spec-value {
    font-weight: 700;
    font-size: 16px;
    margin-bottom: 4px;
  }

  .spec-label {
    color: #666;
    font-size: 14px;
  }

  .product-price {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 25px;
  }

  .price-current {
    font-size: 40px;
    font-weight: 700;
    color: #ff6b00;
  }

  .price-original {
    font-size: 24px;
    color: #999;
    text-decoration: line-through;
  }

  .price-save {
    background: #ffe5e5;
    color: #ff0000;
    padding: 6px 12px;
    border-radius: 4px;
    font-size: 13px;
    font-weight: 600;
  }

  .product-form {
    margin-bottom: 20px;
  }

  .quantity-cart {
    display: flex;
    gap: 15px;
    margin-bottom: 20px;
  }

  .quantity-selector {
    display: flex;
    align-items: center;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    overflow: hidden;
  }

  .quantity-btn {
    width: 40px;
    height: 48px;
    border: none;
    background: white;
    cursor: pointer;
    font-size: 18px;
    transition: background 0.3s;
  }

  .quantity-btn:hover {
    background: #f5f5f5;
  }

  .quantity-input {
    width: 60px;
    height: 48px;
    border: none;
    text-align: center;
    font-size: 16px;
    font-weight: 600;
  }

  .stock-status {
    padding: 0 15px;
    display: flex;
    align-items: center;
    color: #666;
    font-size: 14px;
  }

  .add-to-cart-btn {
    flex: 1;
    background: #000;
    color: white;
    border: none;
    padding: 14px 30px;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: background 0.3s;
  }

  .add-to-cart-btn:hover {
    background: #333;
  }

  .action-buttons {
    display: flex;
    gap: 10px;
  }

  .icon-btn {
    width: 48px;
    height: 48px;
    border: 1px solid #e0e0e0;
    background: white;
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
  }

  .icon-btn:hover {
    border-color: #000;
  }

  .product-benefits {
    display: flex;
    flex-direction: column;
    gap: 10px;
    padding-top: 20px;
    border-top: 1px solid #e0e0e0;
  }

  .benefit-item {
    display: flex;
    align-items: center;
    gap: 8px;
    color: #666;
    font-size: 14px;
  }

  .benefit-item::before {
    content: "✓";
    color: #4caf50;
    font-weight: 700;
  }

  .product-tabs {
    margin-top: 60px;
  }

  .tab-navigation {
    display: flex;
    gap: 40px;
    border-bottom: 2px solid #e0e0e0;
    margin-bottom: 30px;
  }

  .tab-button {
    background: none;
    border: none;
    padding: 15px 0;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    position: relative;
    color: #666;
    transition: color 0.3s;
  }

  .tab-button.active {
    color: #000;
  }

  .tab-button.active::after {
    content: "";
    position: absolute;
    bottom: -2px;
    left: 0;
    right: 0;
    height: 2px;
    background: #000;
  }

  .tab-content {
    display: none;
  }

  .tab-content.active {
    display: block;
  }

  .description-content h3 {
    font-size: 24px;
    margin-bottom: 20px;
  }

  .description-content p {
    line-height: 1.8;
    color: #333;
    margin-bottom: 20px;
  }

  .key-features {
    margin-top: 30px;
  }

  .key-features h3 {
    font-size: 20px;
    margin-bottom: 20px;
  }

  .features-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
  }

  .feature-item {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .feature-item::before {
    content: "●";
    color: #ff6b00;
    font-size: 12px;
  }

  .related-products {
    margin-top: 80px;
  }

  .related-products h2 {
    font-size: 28px;
    margin-bottom: 30px;
  }

  .products-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 20px;
  }

  .product-card {
    border: 1px solid #e0e0e0;
    border-radius: 12px;
    overflow: hidden;
    transition: transform 0.3s, box-shadow 0.3s;
    background: white;
  }

  .product-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }

  .product-card-image {
    aspect-ratio: 1;
    background: #f5f5f5;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .product-card-image img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
  }

  .wishlist-btn {
    position: absolute;
    top: 12px;
    right: 12px;
    width: 36px;
    height: 36px;
    background: white;
    border: 1px solid #e0e0e0;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
  }

  .product-card-info {
    padding: 20px;
  }

  .product-card-category {
    font-size: 12px;
    color: #666;
    text-transform: uppercase;
    margin-bottom: 8px;
  }

  .product-card-title {
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 10px;
  }

  .product-card-rating {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 15px;
    font-size: 14px;
  }

  .product-card-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .product-card-price {
    font-size: 20px;
    font-weight: 700;
    color: #ff6b00;
  }

  .product-card-btn {
    background: #000;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 6px;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.3s;
  }

  .product-card-btn:hover {
    background: #333;
  }

  @media (max-width: 768px) {
    .product-container {
      grid-template-columns: 1fr;
    }

    .product-specs {
      grid-template-columns: repeat(3, 1fr);
    }

    .products-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }
</style>

<div class="product-page">
  <!-- Breadcrumb -->
  <div class="breadcrumb">
    <a href="/">← Back to Games</a>
    <span>/</span>
    <a href="/">Home</a>
    <span>/</span>
    <a href="/collections/games">Games</a>
    <span>/</span>
    <span>{{ product.title }}</span>
  </div>

  <!-- Product Container -->
  <div class="product-container">
    <!-- Product Images -->
    <div class="product-images">
      {% if product.compare_at_price > product.price %}
        <div class="sale-badge">Sale</div>
      {% endif %}
      
      <div class="main-image">
        {% if product.featured_image %}
          <img src="{{ product.featured_image | img_url: '800x' }}" alt="{{ product.title }}" id="mainImage">
        {% else %}
          <svg width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="#ccc" stroke-width="1">
            <rect x="3" y="3" width="18" height="18" rx="2"/>
            <circle cx="8.5" cy="8.5" r="1.5"/>
            <polyline points="21 15 16 10 5 21"/>
          </svg>
        {% endif %}
      </div>

      <div class="thumbnail-container">
        {% for image in product.images limit: 4 %}
          <div class="thumbnail {% if forloop.first %}active{% endif %}" onclick="changeImage('{{ image | img_url: '800x' }}', this)">
            <img src="{{ image | img_url: '200x' }}" alt="{{ product.title }}">
          </div>
        {% endfor %}
      </div>
    </div>

    <!-- Product Info -->
    <div class="product-info">
      <div class="product-meta">
        <span class="category-badge">{{ product.type | default: "Strategy" }}</span>
        {% if product.available %}
          <span class="stock-badge">In Stock</span>
        {% else %}
          <span class="stock-badge" style="background: #999;">Out of Stock</span>
        {% endif %}
      </div>

      <h1 class="product-title">{{ product.title }}</h1>

      <div class="product-rating">
        <div class="stars">
          ★★★★<span style="color: #ddd;">★</span>
        </div>
        <span class="rating-score">4.8</span>
        <span class="review-count">(1247 reviews)</span>
      </div>

      <div class="product-specs">
        <div class="spec-item">
          <div class="spec-icon">👥</div>
          <div class="spec-value">3-4</div>
          <div class="spec-label">Players</div>
        </div>
        <div class="spec-item">
          <div class="spec-icon">⏱️</div>
          <div class="spec-value">60-90 min</div>
          <div class="spec-label">Play Time</div>
        </div>
        <div class="spec-item">
          <div class="spec-icon">🎯</div>
          <div class="spec-value">Medium</div>
          <div class="spec-label">Complexity</div>
        </div>
      </div>

      <div class="product-price">
        <span class="price-current">{{ product.price | money }}</span>
        {% if product.compare_at_price > product.price %}
          <span class="price-original">{{ product.compare_at_price | money }}</span>
          <span class="price-save">Save {{ product.compare_at_price | minus: product.price | money }}</span>
        {% endif %}
      </div>

      {% form 'product', product, class: 'product-form' %}
        <div class="quantity-cart">
          <div class="quantity-selector">
            <button type="button" class="quantity-btn" onclick="updateQuantity(-1)">−</button>
            <input type="number" name="quantity" value="1" min="1" class="quantity-input" id="quantity">
            <button type="button" class="quantity-btn" onclick="updateQuantity(1)">+</button>
          </div>
          <span class="stock-status">In Stock</span>
        </div>

        <div class="quantity-cart">
          <button type="submit" class="add-to-cart-btn" {% unless product.available %}disabled{% endunless %}>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="9" cy="21" r="1"/>
              <circle cx="20" cy="21" r="1"/>
              <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
            </svg>
            Add to Cart
          </button>
          <button type="button" class="icon-btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
            </svg>
          </button>
          <button type="button" class="icon-btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="18" cy="5" r="3"/>
              <circle cx="6" cy="12" r="3"/>
              <circle cx="18" cy="19" r="3"/>
              <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/>
              <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
            </svg>
          </button>
        </div>
      {% endform %}

      <div class="product-benefits">
        <div class="benefit-item">Free shipping on orders over $75</div>
        <div class="benefit-item">30-day return policy</div>
        <div class="benefit-item">Secure payment processing</div>
      </div>
    </div>
  </div>

  <!-- Product Tabs -->
  <div class="product-tabs">
    <div class="tab-navigation">
      <button class="tab-button active" onclick="switchTab(0)">Description</button>
      <button class="tab-button" onclick="switchTab(1)">Specifications</button>
      <button class="tab-button" onclick="switchTab(2)">Components</button>
      <button class="tab-button" onclick="switchTab(3)">Reviews (1247)</button>
    </div>

    <div class="tab-content active">
      <div class="description-content">
        <h3>About This Game</h3>
        {{ product.description }}
        
        <div class="key-features">
          <h3>Key Features</h3>
          <div class="features-grid">
            <div class="feature-item">Award-winning gameplay</div>
            <div class="feature-item">Perfect for family game nights</div>
            <div class="feature-item">High replay value</div>
            <div class="feature-item">Easy to learn, hard to master</div>
            <div class="feature-item">Encourages social interaction</div>
            <div class="feature-item">Multiple expansion packs available</div>
          </div>
        </div>
      </div>
    </div>

    <div class="tab-content">
      <p>Product specifications content here...</p>
    </div>

    <div class="tab-content">
      <p>Components list content here...</p>
    </div>

    <div class="tab-content">
      <p>Reviews content here...</p>
    </div>
  </div>

  <!-- Related Products -->
  {% if recommendations.products.size > 0 %}
  <div class="related-products">
    <h2>You Might Also Like</h2>
    <div class="products-grid">
      {% for product in recommendations.products limit: 4 %}
        <div class="product-card">
          <div class="product-card-image">
            {% if product.featured_image %}
              <img src="{{ product.featured_image | img_url: '400x' }}" alt="{{ product.title }}">
            {% endif %}
            <button class="wishlist-btn">♡</button>
          </div>
          <div class="product-card-info">
            <div class="product-card-category">{{ product.type }}</div>
            <div class="product-card-title">{{ product.title }}</div>
            <div class="product-card-rating">
              <span style="color: #ffc107;">★</span>
              <span>4.5</span>
            </div>
            <div class="product-card-footer">
              <span class="product-card-price">{{ product.price | money }}</span>
              <button class="product-card-btn">Add to Cart</button>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}
</div>

<script>
  function changeImage(src, element) {
    document.getElementById('mainImage').src = src;
    document.querySelectorAll('.thumbnail').forEach(thumb => thumb.classList.remove('active'));
    element.classList.add('active');
  }

  function updateQuantity(change) {
    const input = document.getElementById('quantity');
    const currentValue = parseInt(input.value) || 1;
    const newValue = Math.max(1, currentValue + change);
    input.value = newValue;
  }

  function switchTab(index) {
    const buttons = document.querySelectorAll('.tab-button');
    const contents = document.querySelectorAll('.tab-content');
    
    buttons.forEach((btn, i) => {
      btn.classList.toggle('active', i === index);
    });
    
    contents.forEach((content, i) => {
      content.classList.toggle('active', i === index);
    });
  }
</script>